---
title: "Distributional Analyses"
author: "Jamie Cummins"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    code_folding: hide
    highlight: haddock
    theme: flatly
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

```{r include=FALSE}

knitr::opts_chunk$set(message = FALSE, 
                      warning = FALSE, 
                      cache = TRUE,
                      echo = FALSE)

```

```{r}
library(tidyverse)

exp_1_df <- read_csv("experiment 1/data/processed/processed_data.csv")
exp_2_df <- read_csv("experiment 2/data/processed/processed_data.csv")
exp_3_df <- read_csv("experiment 3/data/processed/processed_data.csv")
exp_4_df <- read_csv("experiment 4/data/processed/processed_data.csv")
exp_5_df <- read_csv("experiment 5 pilot/data/processed/processed_data.csv")

```

# Density plots

## Experiment 1 

Distribution of IA-AMP effect in Experiment 1 appears somewhat bimodal. Shape is descriptively similar to that of Mann et al.'s findings.

```{r}
ggplot(exp_1_df, aes(IA_AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP effect", title = "Density plot: Experiment 1") +
  theme_classic()

```

## Experiment 2 

Distribution of both AMP effects in Experiment 2 appear bimodal.

```{r}
a <- ggplot(exp_2_df, aes(AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "Standard AMP effect", title = "Density plots: Experiment 2") +
  theme_classic()

b <- ggplot(exp_2_df, aes(IA_AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP effect") +
  theme_classic()

library(patchwork)
a + b
```

## Experiment 3 

Distribution of both AMP effects in Experiment 3 appear bimodal.

```{r}
c <- ggplot(exp_3_df, aes(AMP_effect_obama_trump)) +
  geom_density(adjust = .5) +
  labs(x = "Standard Trump-Obama AMP effect", title = "Density plots: Experiment 3") +
  theme_classic()

d <- ggplot(exp_3_df, aes(IA_AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP positive/negative effect") +
  theme_classic()

library(patchwork)
c + d
```

## Experiment 4 

Distribution of the positive/negative AMP effect in Experiment 4 appears bimodal.

Distribution of the Trump/Obama is trimodal.

```{r}
e <- ggplot(exp_4_df, aes(IA_AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP positive/negative effect", title = "Density plots: Experiment 4") +
  theme_classic()

f <- ggplot(exp_4_df, aes(IA_AMP_effect_obama_trump)) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP Trump-Obama effect") +
  theme_classic()

library(patchwork)
e + f
```

## Experiment 4: make Trump/Obama IA-AMP absolute

Making scores in the Trump/Obama IA-AMP shows more evidence of bimodality.

```{r}
ggplot(exp_4_df, aes(abs(IA_AMP_effect_obama_trump))) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP Trump-Obama effect", title = "Density plots: Experiment 4") +
  theme_classic()

```

## Experiment 5

Using the Mann et al. AMPs might descriptively reduce bimodality somewhat, but it does not eliminate it completely.

```{r}
g <- ggplot(exp_5_df, aes(IA_AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "IA-AMP effect", title = "Density plots: Experiment 5") +
  theme_classic()

h <- ggplot(exp_5_df, aes(AMP_effect_positive_negative)) +
  geom_density(adjust = .5) +
  labs(x = "AMP effect") +
  theme_classic()

g + h

```

# Comparing distributions between Exp 2 and Exp 5 

No evidence for differences between the distributions of the original AMP vs. the Mann AMP in the case of either the Standard AMPs, or the IA-AMPs.

```{r}
ks.test(exp_2_df$AMP_effect_positive_negative, exp_5_df$AMP_effect_positive_negative)

ks.test(exp_2_df$IA_AMP_effect_positive_negative, exp_5_df$IA_AMP_effect_positive_negative)
```


```{r}

joined_temp <- exp_2_df %>%
  rbind(exp_5_df) %>%
  mutate(exp = c(rep(2, nrow(exp_2_df)), rep(5, nrow(exp_5_df))))

temp_fit <- lm(IA_AMP_effect_positive_negative ~ influence_rate * exp,
               data = joined_temp)
tab_model(temp_fit, show.std = TRUE)
plot_model(temp_fit, type = "int")

```

```{r}
temp_fit <- lm(AMP_effect_positive_negative ~
                 IA_AMP_effect_positive_negative * exp,
               data = joined_temp)
tab_model(temp_fit, show.std = TRUE)
plot_model(temp_fit, type = "int")
```